#!/usr/bin/env rakudo

use Data::Generators;
use Test;

my $mixmaster = $*PROGRAM.IO.parent(2).add('bin/mixmaster');
my $proc = run $mixmaster, qqw[--job {~random-string} recipe], :out, :err;
my $stdout = $proc.out.slurp: :close;
my $stderr = $proc.err.slurp: :close;

plan 3;

is $stdout, "", "Stdout is empty";
like $stderr.lines[0], / 'not readable' $ /, "Error message is written to stderr";
is $proc.exitcode, 3, "Exits with error status";

done-testing;
